var u={alpha:"[A-Za-z]+",alphanum:"[A-Za-z0-9]+",int:"[0-9]+",decimal:"[0-9.]+",currency:"[0-9]+[.]?[0-9]{0,2}",currency_locale:"[0-9., \u202F\xA0]+([.,][0-9]{0,2})?",date:"[0-9]{0,4}(-[0-2]?[0-9]?)?(-[0-3]?[0-9]?)?",time:"[0-2]?[0-9](:[0-9]{0,2})?(:[0-9]{0,2})?",time_hm:"[0-2]?[0-9](:[0-9]{0,2})?",creditcard:"[0-9]{0,4}( [0-9]{0,4})?( [0-9]{0,4})?( [0-9]{0,4})?"},n=[" ",".",",","-",":"],h=class{constructor(t){if(this.el=t,this.regex=null,this.el.dataset.alias){let a=u[this.el.dataset.alias]??"";t.setAttribute("pattern",a)}t.hasAttribute("pattern")&&(this.regex=new RegExp("^"+t.getAttribute("pattern")+"$","u")),this.setDefaultPlaceholder(),this.el.addEventListener("beforeinput",a=>{let e=this.el.value;if(!a.data||!this.regex||(e+=a.data,e.length===0))return;let i=this.getDecimalSeparator(),r=!1;if(this.el.hasAttribute("maxlength")&&["currency","currency_locale","decimal"].includes(this.el.dataset.alias)){let l=this.el.getAttribute("maxlength");a.data!=i&&!e.includes(i)&&(l-=3),e.length>l&&(a.preventDefault(),r=!0)}if(this.regex.test(e)||(a.preventDefault(),r=!0),r){if(this.el.value.length&&n.includes(a.data))switch(this.el.dataset.alias){case"decimal":case"currency":case"currency_locale":this.el.value.includes(i)||(this.el.value=this.el.value+i);break;case"date":this.el.value.length<8&&(this.el.value=this.el.value+"-");break;case"time":case"time_hm":this.el.value.length<6&&(this.el.value=this.el.value+":");case"creditcard":this.el.value.length<16&&(this.el.value=this.el.value+" ");break}if(!Number.isNaN(Number.parseInt(a.data))){let l=this.el.value.length;switch(this.el.dataset.alias){case"date":(l===4||l===7)&&(this.el.value=this.el.value+"-"+a.data);break;case"time":case"time_hm":(l===2||l===5)&&(this.el.value=this.el.value+":"+a.data);case"creditcard":(l===4||l===9||l===14)&&(this.el.value=this.el.value+" "+a.data);break}}}}),this.el.addEventListener("focus",a=>{!this.el.value||this.el.dataset.alias=="currency_locale"&&(this.el.value=this.getUnformattedValue())}),this.el.addEventListener("blur",a=>{if(!this.el.value)return;let e,i,r,l;switch(this.el.dataset.alias){case"decimal":i=new Intl.NumberFormat("en-US",{useGrouping:!1});break;case"currency":i=new Intl.NumberFormat("en-US",{useGrouping:!1,maximumFractionDigits:2,minimumFractionDigits:2});break;case"currency_locale":i=this.getLatinFormatter();break;case"date":for(r="-",e=this.el.value.split(r).filter(Number),e[0]||(e[0]=new Date().getFullYear());e.length<3;)e.push("01");for(;e[0].length<4;)e[0]+="0";for(;e[1].length<2;)e[1]="0"+e[1];for(;e[2].length<2;)e[2]="0"+e[2];break;case"time":case"time_hm":let c=this.el.dataset.alias==="time"?3:2;for(r=":",e=this.el.value.split(r);e.length<c;)e.push("00");for(let s=0;s<c;s++)for(;e[s].length<2;)e[s]+="0";break}i&&(l=i.format(this.getRawValue()),l!="NaN"&&(this.el.value=l)),e&&(this.el.value=e.join(r))})}setDefaultPlaceholder(){if(this.el.hasAttribute("placeholder"))return;let t;switch(this.el.dataset.alias){case"alpha":this.el.hasAttribute("maxlength")&&(t="a".repeat(this.el.getAttribute("maxlength")));break;case"alphanum":this.el.hasAttribute("maxlength")&&(t="\xB7".repeat(this.el.getAttribute("maxlength")));break;case"int":this.el.hasAttribute("maxlength")&&(t="0".repeat(this.el.getAttribute("maxlength")));break;case"decimal":case"currency":case"currency_locale":this.el.hasAttribute("maxlength")&&(t="0".repeat(this.el.getAttribute("maxlength")-3),t+=this.getSeparator()+"00");break;case"date":t="yyyy-mm-dd";break;case"time":t="hh:mm:ss";break;case"time_hm":t="hh:mm";break;case"creditcard":t="\xB7\xB7\xB7\xB7 \xB7\xB7\xB7\xB7 \xB7\xB7\xB7\xB7 \xB7\xB7\xB7\xB7";break}t&&this.el.setAttribute("placeholder",t)}getUnformattedValue(){let t=this.getDecimalSeparator();return this.el.value.replace(new RegExp("[^0-9\\"+t+"]","g"),"")}getRawValue(){return this.getUnformattedValue().replace(this.getDecimalSeparator(),".")}getLatinFormatter(){let t={maximumFractionDigits:2,minimumFractionDigits:2},a=Intl.NumberFormat([],t);return a.resolvedOptions().numberingSystem==="latn"?a:new Intl.NumberFormat("en-US",t)}getSeparator(){switch(this.el.dataset.alias){case"int":case"decimal":case"currency":return".";case"currency_locale":return this.getDecimalSeparator();case"date":return"-";case"time":case"time_hm":return":";case"creditcard":return" "}}getDecimalSeparator(){return this.el.dataset.alias!="currency_locale"?".":Intl.NumberFormat().formatToParts(1.1).find(t=>t.type==="decimal").value}static init(t="input.formatter"){document.querySelectorAll(t).forEach(a=>{new h(a)})}},m=h;export{m as default};
//# sourceMappingURL=PatternFormatter.min.js.map
